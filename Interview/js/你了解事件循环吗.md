### 你了解事件循环吗？
事件循环又叫做消息循环，是浏览器渲染主线程的工作方式。
可以理解成，渲染主线程会开启一个不会结束的for循环，每次循环从消息队列中取出第一个任务执行，而其他线程只需要在合适的时候将任务加入到队列末尾即可。

过去把消息队列简单分为宏队列和微队列，其中：
>宏队列主要包含：script(整体代码)、setTimeout、setInterval、I/O、UI交互事件等。宏任务只是一个总的说法，这些任务可能分布在不同的任务队列中

>微队列包含：Promise.then、MutaionObserver、process.nextTick等

现在取而代之的是更灵活的处理方式，有多种队列，比如：微任务队列、定时器队列、交互队列、渲染队列等。

根据W3C官方的解释，每个任务有不同的类型，同类型的任务必须在同一个队列，不同的任务可以属于不同的队列。
不同任务队列有不同的优先级，在-次事件循环中，由浏览器自行决定取哪一个队列的任务.
但浏览器必须有一个微队列，微队列的任务-定具有最高的优先级，必须优先调度执行。

**大致还是以前的运行行机制**：
+ 首先执行一个宏任务
+ 执行过程中遇到微任务，将微任务添加到微任务队列中，遇到宏任务，将其放入宏任务队列中
+ 当前宏任务执行完毕后，立即执行微任务队列，微任务执行过程中，如果遇到宏任务，将其放入宏任务队列，如果碰到微任务，也将其放入微任务队列中，直到微任务全部执行完毕
+ 判断是否需要渲染，如果需要渲染GUI线程接管渲染
+ 渲染完毕后，JS线程继续执行下一个宏任务

**小结**
> 在当前运行环境中，微任务总是先于宏任务执行，因为微任务是在本次渲染前执行，无需等待渲染

**其他 队列的优先级**
微任务队列 > 交互队列 > 渲染队列 > 定时器队列
